(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{156:function(e,t,a){(function(e){function a(e,t){for(var a=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),a++):a&&(e.splice(n,1),a--)}if(t)for(;a--;a)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var a=[],n=0;n<e.length;n++)t(e[n],n,e)&&a.push(e[n]);return a}t.resolve=function(){for(var t="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var i=s>=0?arguments[s]:e.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,r="/"===i.charAt(0))}return(r?"/":"")+(t=a(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var s=t.isAbsolute(e),i="/"===r(e,-1);return(e=a(n(e.split("/"),(function(e){return!!e})),!s).join("/"))||s||(e="."),e&&i&&(e+="/"),(s?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,a){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var a=e.length-1;a>=0&&""===e[a];a--);return t>a?[]:e.slice(t,a-t+1)}e=t.resolve(e).substr(1),a=t.resolve(a).substr(1);for(var r=n(e.split("/")),s=n(a.split("/")),i=Math.min(r.length,s.length),l=i,o=0;o<i;o++)if(r[o]!==s[o]){l=o;break}var u=[];for(o=l;o<r.length;o++)u.push("..");return(u=u.concat(s.slice(l))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),a=47===t,n=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!r){n=s;break}}else r=!1;return-1===n?a?"/":".":a&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var a=function(e){"string"!=typeof e&&(e+="");var t,a=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){a=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(a,n)}(e);return t&&a.substr(-1*t.length)===t&&(a=a.substr(0,a.length-t.length)),a},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,a=0,n=-1,r=!0,s=0,i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47!==l)-1===n&&(r=!1,n=i+1),46===l?-1===t?t=i:1!==s&&(s=1):-1!==t&&(s=-1);else if(!r){a=i+1;break}}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===a+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,a){return e.substr(t,a)}:function(e,t,a){return t<0&&(t=e.length+t),e.substr(t,a)}}).call(this,a(26))},157:function(e,t,a){"use strict";a(65)},158:function(e,t,a){(t=a(3)(!1)).push([e.i,".versionlist_page[data-v-63945f5d]{padding:0 20px}.dropdown[data-v-63945f5d]{margin-bottom:20px}.tabs[data-v-63945f5d]{padding-top:20px}.tabs .versioninfo .line[data-v-63945f5d]{margin:12px 0}.tabs .versioninfo .line .title[data-v-63945f5d]{margin-right:12px}.topmenu[data-v-63945f5d]{display:flex;justify-content:space-between;align-items:center;height:60px;padding:0 20px;margin:20px 0px 0px;border:1px solid #efefef}.topmenu .topmenu_r[data-v-63945f5d]{cursor:pointer}.topmenu .title[data-v-63945f5d]{color:#95b3ce;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.topmenu span.title[data-v-63945f5d]{margin-left:16px}.table .btn[data-v-63945f5d]{display:inline-block;margin-left:20px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.table .auth.btn[data-v-63945f5d]{margin-left:0}\n",""]),e.exports=t},199:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"versionlist_page fillcontain"},[a("div",{staticClass:"tabs"},[a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.currentSystem,callback:function(t){e.currentSystem=t},expression:"currentSystem"}},[a("el-option",{attrs:{label:"Android",value:0}}),e._v(" "),a("el-option",{attrs:{label:"IOS",value:1}})],1)],1),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-radio-group",{on:{change:e.handleChange},model:{value:e.currentApp,callback:function(t){e.currentApp=t},expression:"currentApp"}},[a("el-radio",{attrs:{label:0}},[e._v("股市方圆")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("秀才（股市方圆为内核）")])],1)],1),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版本信息",name:"first"}},[a("div",{staticClass:"versioninfo"},[a("div",{staticClass:"line"},[a("el-button",{attrs:{round:""},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v("更新信息")])],1),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("操作系统")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(0==e.currentSystem?"Android":"IOS"))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("更新标题")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.ruleForm.updateTitle))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("更新内容")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.ruleForm.updateContent))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("最新版本")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.ruleForm.latestVersion))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("最低版本")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.ruleForm.minimumVersion))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("是否需要更新")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(0==e.ruleForm.update?"否":"是"))])]),e._v(" "),a("div",{staticClass:"line"},[a("span",{staticClass:"title"},[e._v("app下载地址")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.ruleForm.appUrl))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.currentSystem,expression:"currentSystem == 0"}],staticClass:"line"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.downloading},on:{click:e.downAPK}},[e._v(e._s(e.downloadTitle))])],1),e._v(" "),a("el-upload",{directives:[{name:"show",rawName:"v-show",value:0==e.currentSystem,expression:"currentSystem == 0"}],ref:"upload",staticClass:"upload-demo",attrs:{action:"/sc/apk/upload","http-request":e.uploadFile,"on-preview":e.handlePreview,"on-remove":e.handleRemove,accept:"apk",limit:1,"file-list":e.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传apk文件")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"更新信息",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"下载地址",prop:"appUrl"}},[a("el-input",{model:{value:e.ruleForm.appUrl,callback:function(t){e.$set(e.ruleForm,"appUrl",t)},expression:"ruleForm.appUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最新版本",prop:"latestVersion"}},[a("el-input",{attrs:{required:""},model:{value:e.ruleForm.latestVersion,callback:function(t){e.$set(e.ruleForm,"latestVersion",t)},expression:"ruleForm.latestVersion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最低支持版本",prop:"minimumVersion"}},[a("el-input",{model:{value:e.ruleForm.minimumVersion,callback:function(t){e.$set(e.ruleForm,"minimumVersion",t)},expression:"ruleForm.minimumVersion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"更新标题",prop:"updateTitle"}},[a("el-input",{model:{value:e.ruleForm.updateTitle,callback:function(t){e.$set(e.ruleForm,"updateTitle",t)},expression:"ruleForm.updateTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"更新内容",prop:"updateContent"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.updateContent,callback:function(t){e.$set(e.ruleForm,"updateContent",t)},expression:"ruleForm.updateContent"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"历史版本",name:"second"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(64, 100, 141, 0.8)",data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"operatingSystem",label:"操作系统",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTitle",label:"更新标题",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateContent",label:"更新内容"}}),e._v(" "),a("el-table-column",{attrs:{prop:"latestVersion",label:"最新版本"}}),e._v(" "),a("el-table-column",{attrs:{prop:"appVersion",label:"最低版本"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update",label:"是否需要更新"}}),e._v(" "),a("el-table-column",{attrs:{prop:"appUrl",label:"app下载地址"}})],1)],1)],1)],1)])};n._withStripped=!0;var r=a(2);a(156);var s=a(24),i=a.n(s),l={data:function(){return{msg:"角色列表",adminInfo:"",operatingSystem:0,currentSystem:0,currentApp:0,tableData:[],fileList:[],loading:!1,downloading:!1,downloadTitle:"下载apk",activeName:"first",centerDialogVisible:!1,ruleForm:{appUrl:"",latestVersion:"",md5:"",minimumVersion:"",operatingSystem:"Android",updateContent:"",updateTitle:""},rules:{latestVersion:[{required:!0,message:"请填写最新版本",trigger:"blur"}],appUrl:[{required:!0,message:"请填写下载地址",trigger:"blur"}],updateContent:[{required:!0,message:"请填写更新内容",trigger:"blur"}],updateTitle:[{required:!0,message:"请填写更新标题",trigger:"blur"}]}}},methods:{initdata:function(){this.queryList()},queryList:function(){var e,t=this,a={os:this.currentSystem,isGsfy:0===this.currentApp};(e=a,Object(r.a)({url:"/uf/query/app/version",method:"post",data:e})).then((function(e){0==e.data.code?null==e.data.data?t.ruleForm={appUrl:"",latestVersion:"",md5:"",minimumVersion:"",operatingSystem:"",update:"",updateContent:"",updateTitle:""}:t.ruleForm={appUrl:e.data.data.appUrl,latestVersion:e.data.data.latestVersion,md5:"",minimumVersion:e.data.data.minimumVersion,operatingSystem:e.data.data.operatingSystem,update:e.data.data.update,updateContent:e.data.data.updateContent,updateTitle:e.data.data.updateTitle}:t.$message({message:e.data.msg?e.data.msg:"查询版本信息失败",type:"error"})})).catch((function(e){t.$message({message:e,type:"error"})})),function(e){return Object(r.a)({url:"/uf/query/history/app/version",method:"post",data:e})}(a).then((function(e){0==e.data.code?(t.tableData=e.data.data,t.tableData.forEach((function(e){0==e.update?e.update="是":e.update="否"}))):t.$message({message:e.data.msg?e.data.msg:"查询app历史信息失败",type:"error"})})).catch((function(e){t.$message({message:e,type:"error"})}))},handleChange:function(){this.queryList()},handleClick:function(e,t){},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a,n=t.ruleForm;n.isGsfy=0===t.currentApp,delete n.update,(a=n,Object(r.a)({url:"/uf/update/app/version",method:"post",data:a})).then((function(e){0==e.data.code?t.$message({message:"更新成功",type:"success"}):t.$message({message:e.data.msg?e.data.msg:"更新失败",type:"error"})})).catch((function(e){t.$message({message:e,type:"error"})}))}))},handleRemove:function(e,t){this.cancel&&(this.cancel(),this.$refs.upload.abort())},handlePreview:function(e){this.cancel&&(this.cancel(),this.$refs.upload.abort())},uploadFile:function(e){var t=this,a=e.file,n=i.a.CancelToken,r=this;if(-1==a.name.indexOf(".apk"))return this.$message.error("上传文件必须是apk文件"),this.fileList=[],!1;var s=new FormData;s.append("apk",a),i.a.post("/sc/apk/upload",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){var a=t.loaded/t.total*100|0;e&&e.onProgress({percent:a})}},{cancelToken:new n((function(e){r.cancel=e}))}).then((function(a){0==a.data.code?(t.$message({message:"上传成功",type:"success"}),e.onSuccess()):t.$message({message:a.data.msg?a.data.msg:"上传失败",type:"error"})})).catch((function(a){t.$message({message:a.msg,type:"error"}),e.onError()}))},submitUpload:function(e){return e.preventDefault(),this.$refs.upload.submit(),!1},downAPK:function(){this.downloading=!0,this.downloadTitle="下载中";var e=this,t=new XMLHttpRequest,a=this.ruleForm.appUrl.split("/"),n="/sc/apk/download/"+a[a.length-1];t.open("post",n,!0),t.responseType="blob",t.onload=function(){if(200==this.status){e.downloading=!1,e.downloadTitle="下载apk";var t=this.response,n=new Blob([t],{type:"application/octet-stream"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=a[a.length-1],document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}},t.send()}},created:function(){this.initdata()}},o=(a(157),a(1)),u=Object(o.a)(l,n,[],!1,null,"63945f5d",null);u.options.__file="src/page/versionManage/versionlist.vue",t.default=u.exports},65:function(e,t,a){var n=a(158);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals),(0,a(4).default)("7a17fcc2",n,!1,{})}}]);