(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,a){"use strict";function n(t){return t||""}function i(t){return t||!1}function s(t){for(var e in t)""===t[e]&&delete t[e];return t}function o(t){for(var e=String.fromCharCode(t.charCodeAt(0)+t.length),a=1;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)+t.charCodeAt(a-1));return escape(e)}function r(t){t=unescape(t);for(var e=String.fromCharCode(t.charCodeAt(0)-t.length),a=1;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)-e.charCodeAt(a-1));return e}function c(t){if(!e)var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function l(t){if(!e)var e=new Date(t);return e.getFullYear()+""+(e.getMonth()+1)}function u(t){var e=this,a=!1;if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=t.headers["content-type"]&&"application/vnd.ms-excel"!=t.headers["content-type"]||(a=!0),a){var n=new Blob([t.data],{type:"application/vnd.ms-excel"}),i=t.headers["content-disposition"].split(";")[1].split("=")[1];if("download"in document.createElement("a")){var s=document.createElement("a");s.style.display="none",s.href=window.URL.createObjectURL(n),s.download=decodeURIComponent(i),document.body.appendChild(s),s.click(),URL.revokeObjectURL(s.href),document.body.removeChild(s)}else navigator.msSaveBlob(n,i)}else{var o=new FileReader;o.onload=function(t){return e.$message.error(JSON.parse(t.target.result).msg)},o.readAsText(t.data)}}function d(t,e,a){var n;return function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var r=this;if(n&&clearTimeout(n),a){var c=!n;n=setTimeout((function(){n=null}),e),c&&t.apply(r,s)}else n=setTimeout((function(){t.apply(r,s)}),e)}}a.d(e,"f",(function(){return n})),a.d(e,"d",(function(){return i})),a.d(e,"h",(function(){return s})),a.d(e,"e",(function(){return o})),a.d(e,"i",(function(){return r})),a.d(e,"a",(function(){return c})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return u})),a.d(e,"g",(function(){return d})),a(27)},10:function(t,e,a){"use strict";a.d(e,"h",(function(){return i})),a.d(e,"g",(function(){return s})),a.d(e,"c",(function(){return o})),a.d(e,"i",(function(){return r})),a.d(e,"a",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"e",(function(){return p}));var n=a(2);function i(t){return Object(n.a)({url:"/api/order/query",method:"post",data:t})}function s(t){return Object(n.a)({url:"/api/act/get/acts",method:"post",data:t})}function o(t){return Object(n.a)({url:"/api/act/add",method:"post",data:t})}function r(t){return Object(n.a)({url:"/api/act/update",method:"post",data:t})}function c(t){return Object(n.a)({url:"/api/act/delete",method:"get",params:t})}function l(t){return Object(n.a)({url:"/api/act/upDown",method:"get",params:t})}function u(t){return Object(n.a)({url:"/api/act/getActById",method:"get",params:t})}function d(t){return Object(n.a)({url:"/api/act/checkActName",method:"post",params:t})}function p(t){return Object(n.a)({url:"/api/act/checkGoodsInAct",method:"post",data:t})}},121:function(t,e,a){"use strict";a(49)},122:function(t,e,a){(e=a(3)(!1)).push([t.i,".activityList_page[data-v-39b84f81]{padding:0 20px}.topmenu[data-v-39b84f81]{display:flex;justify-content:space-between;align-items:center;height:60px;padding:0 20px;margin:20px 0px 0px;border:1px solid #efefef}.topmenu .topmenu_r[data-v-39b84f81]{cursor:pointer}.topmenu .title[data-v-39b84f81]{color:#95b3ce;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.topmenu span.title[data-v-39b84f81]{margin-left:16px}.topmenu_new[data-v-39b84f81]{display:flex;flex-direction:column;margin:0px;border:1px solid #efefef;color:#606266}.topmenu_new .topmenu_t[data-v-39b84f81],.topmenu_new .topmenu_b[data-v-39b84f81]{display:flex;padding:20px 20px;border-bottom:1px solid #efefef}.topmenu_new .topmenu_b[data-v-39b84f81]{justify-content:flex-start;align-items:center}.topmenu_new .topmenu_b button[data-v-39b84f81]{cursor:pointer;background:#FFF;border:1px solid #DCDFE6;color:#606266;padding:12px 20px;font-size:14px;border-radius:4px;margin-right:23px}.topmenu_new .topmenu_b button[data-v-39b84f81]:hover{background:#66b1ff;border-color:#66b1ff;color:#FFF}.topmenu_new .topmenu_b button.active[data-v-39b84f81]{background:#66b1ff;border-color:#66b1ff;color:#FFF}.topmenu_new .topmenu_t[data-v-39b84f81]{justify-content:flex-start}.topmenu_new .topmenu_t .timeline[data-v-39b84f81]{cursor:pointer}.topmenu_new .topmenu_t span[data-v-39b84f81]{margin-right:10px;color:#95b3ce;font-size:14px}.topmenu_new .topmenu_t .time[data-v-39b84f81],.topmenu_new .topmenu_t .operator[data-v-39b84f81]{margin-right:30px}.topmenu_new .topmenu_t .operator_input[data-v-39b84f81]{width:180px}.topmenu_new .title[data-v-39b84f81]{color:#95b3ce;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.table[data-v-39b84f81]{overflow-x:auto}.table[data-v-39b84f81] ::-webkit-scrollbar{width:5px;height:5px}.table .btn[data-v-39b84f81]{display:inline-block;margin-left:20px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.table .auth.btn[data-v-39b84f81]{margin-left:0}.Pagination[data-v-39b84f81]{display:flex;justify-content:space-between;margin-top:8px}\n",""]),t.exports=e},216:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"activityList_page fillcontain"},[a("div",{staticClass:"topmenu"},[t._m(0),t._v(" "),a("el-button",{staticClass:"topmenu_r",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:t.addActivity}},[a("span",[t._v("活动添加")])])],1),t._v(" "),a("div",{staticClass:"topmenu_new"},[a("div",{staticClass:"topmenu_t"},[a("div",{staticClass:"operator"},[a("el-input",{staticClass:"operator_input",attrs:{clearable:"",placeholder:"活动名称/活动编号"},model:{value:t.activityname,callback:function(e){t.activityname=e},expression:"activityname"}})],1),t._v(" "),a("div",{staticClass:"time"},[a("span",[t._v("活动时间：")]),t._v(" "),a("el-date-picker",{staticClass:"timeline",attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.timeline,callback:function(e){t.timeline=e},expression:"timeline"}})],1),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.select}},[t._v("搜索")])],1),t._v(" "),a("div",{staticClass:"topmenu_b"},[a("button",{staticClass:"active",on:{click:function(e){return t.active(e,3)}}},[t._v("所有")]),t._v(" "),a("button",{on:{click:function(e){return t.active(e,1)}}},[t._v("进行中")]),t._v(" "),a("button",{on:{click:function(e){return t.active(e,0)}}},[t._v("未开始")]),t._v(" "),a("button",{on:{click:function(e){return t.active(e,2)}}},[t._v("已结束")]),t._v(" "),a("button",{on:{click:function(e){return t.active(e,4)}}},[t._v("置顶")])])]),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中",data:t.tableData,"span-method":t.objectSpanMethod,border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"activityID",label:"活动编号","min-width":"230"}}),t._v(" "),a("el-table-column",{attrs:{prop:"activityName",label:"活动名称",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"activityDate",label:"活动日期","min-width":"230"}}),t._v(" "),a("el-table-column",{attrs:{prop:"activityState",label:"活动状态",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"goodsName",label:"商品名称","min-width":"236"}}),t._v(" "),a("el-table-column",{attrs:{prop:"actGoodsName",label:"商品活动名称","min-width":"230"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sold",label:"库存",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"freeze",label:"冻结",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pendingSale",label:"待销售",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"activityPrice",label:"活动价格(元)",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"btn",on:{click:function(a){return t.toedit(e.row.id)}}},[a("i",{staticClass:"el-icon-edit"}),t._v(" "),a("span",[t._v("编辑")])]),t._v(" "),a("div",{directives:[{name:"permission",rawName:"v-permission",value:{params:["activityManage","delete"],do:t.tocancle,query:{index:e.$index,data:e.row}},expression:"{ params: ['activityManage','delete'] , do: tocancle , query: { index:scope.$index,data: scope.row } }"}],staticClass:"btn"},[a("i",{staticClass:"el-icon-circle-close"}),t._v(" "),a("span",[t._v("删除")])]),t._v(" "),0==e.row.salesStatus?a("div",{directives:[{name:"permission",rawName:"v-permission",value:{params:["activityManage","saleOnOrOff"],do:t.toput,query:{status:1,id:e.row.id}},expression:"{ params: ['activityManage','saleOnOrOff'] , do: toput , query: { status:1,id: scope.row.id } }"}],staticClass:"btn"},[a("i",{staticClass:"el-icon-refresh"}),t._v(" "),a("span",[t._v("上架")])]):a("div",{directives:[{name:"permission",rawName:"v-permission",value:{params:["activityManage","saleOnOrOff"],do:t.toput,query:{status:0,id:e.row.id}},expression:"{ params: ['activityManage','saleOnOrOff'] , do: toput , query: { status:0,id: scope.row.id } }"}],staticClass:"btn"},[a("i",{staticClass:"el-icon-refresh"}),t._v(" "),a("span",[t._v("下架")])])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[3,5,10,20],"page-size":t.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])};n._withStripped=!0;var i=a(10),s=a(0),o={data:function(){return{msg:"4",adminInfo:"",currentPage:1,loading:!0,offset:1,limit:10,pagesize:1,count:10,timeline:"",status:"",activityname:"",multipleSelection:[],tableData:[]}},methods:{initdata:function(){var t={limit:this.limit,offset:this.offset};this.getActList(t)},setParams:function(){var t={beginTime:"",endTime:"",limit:this.limit,nameOrCode:this.activityname,offset:this.offset,status:this.status};return this.timeline&&(t.beginTime=Object(s.a)(this.timeline[0]),t.endTime=Object(s.a)(this.timeline[1])),t},getActList:function(t){var e=this;Object(i.g)(Object(s.h)(t)).then((function(t){t.data.flag?(e.loading=!1,e.tableData=[],t.data.data.rows.forEach((function(t,a){if(t.goodsList.length>1)t.goodsList.forEach((function(a,n){var i={id:t.id,activityID:t.code,activityName:t.name,activityDate:t.startTime+"到"+t.endTime,activityState:e.setStatus(t.status),salesStatus:t.salesStatus,goodsName:a.goodsName,actGoodsName:a.name,sold:a.soldNumber,freeze:a.freezeNumber,pendingSale:a.surplusNum,activityPrice:a.discountedPrice};0==n&&(i.rowspan=t.goodsList.length),e.tableData.push(i)}));else{var n={id:t.id,activityID:t.code,activityName:t.name,activityDate:t.startTime+"到"+t.endTime,activityState:e.setStatus(t.status),salesStatus:t.salesStatus,goodsName:t.goodsList[0].goodsName,actGoodsName:t.goodsList[0].name,sold:t.goodsList[0].soldNumber,freeze:t.goodsList[0].freezeNumber,pendingSale:t.goodsList[0].surplusNum,activityPrice:t.goodsList[0].discountedPrice};e.tableData.push(n)}})),e.count=t.data.data.total):(e.loading=!1,e.$message({message:t.data.msg,type:"error"}))})).catch((function(t){e.loading=!1,e.$message({message:t,type:"error"})}))},setStatus:function(t){switch(t){case 0:return"未开始";case 1:return"进行中";case 2:return"已结束"}},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;if(a<5||11==a)return this.rowIndexList.includes(e)?{rowspan:this.rowspanList[this.rowIndexList.indexOf(e)],colspan:1}:this.rowIndexNullList.includes(e)?{rowspan:0,colspan:0}:{rowspan:1,colspan:1}},toggleSelection:function(t){var e=this;t?t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},toedit:function(t){this.$router.push({path:"/activityManage/editActivity",query:{id:t}})},tocancle:function(t){var e=this;window.confirm("请确定是否删除")&&Object(i.a)({id:t.data.id}).then((function(a){a.data.flag?(e.$message({message:"删除成功",type:"success"}),t.data.rowspan?e.tableData.splice(t.index,t.data.rowspan):e.tableData.splice(t.index,1)):e.$message({message:a.data.msg?a.data.msg:"删除失败",type:"error"})})).catch((function(t){e.$message({message:t,type:"error"})}))},toput:function(t){var e=this;if(1==t.status)var a=window.confirm("请确定是否上架");else a=window.confirm("请确定是否下架");if(a){var n={id:t.id,salesStatus:t.status};Object(i.b)(n).then((function(t){t.data.flag?(1==n.salesStatus?e.$message({message:"上架成功",type:"success"}):e.$message({message:"下架成功",type:"success"}),e.$router.go(0)):1==n.salesStatus?e.$message({message:t.data.msg?t.data.msg:"上架失败",type:"error"}):e.$message({message:t.data.msg?t.data.msg:"下架失败",type:"error"})})).catch((function(t){e.$message({message:t,type:"error"})}))}},active:function(t,e){for(var a=0;a<t.target.parentNode.children.length;a++)t.target.parentNode.children[a].className="";switch(this.status=e,t.target.className="active",e){case 3:this.status="",this.getActList(this.setParams());break;case 1:this.status=1,this.getActList(this.setParams());break;case 0:this.status=0,this.getActList(this.setParams());break;case 2:this.status=2,this.getActList(this.setParams())}},addActivity:function(){this.$router.push("/activityManage/addActivity")},handleSizeChange:function(t){this.loading=!0,this.limit=t;var e=this.setParams();this.getActList(e)},handleCurrentChange:function(t){this.loading=!0,this.currentPage=t,this.offset=t;var e=this.setParams();this.getActList(e)},select:function(){this.getActList(this.setParams())}},created:function(){this.initdata()},computed:{rowIndexList:function(){var t=[];return this.tableData.length>0&&this.tableData.forEach((function(e,a){e.rowspan&&t.push(a)})),t},rowIndexNullList:function(){var t=[];return this.tableData.length>0&&this.tableData.forEach((function(e,a){if(e.rowspan)for(var n=1;n<e.rowspan;n++)t.push(a+n)})),t},rowspanList:function(){var t=[];return this.tableData.length>0&&this.tableData.forEach((function(e,a){e.rowspan&&t.push(e.rowspan)})),t}}},r=(a(121),a(1)),c=Object(r.a)(o,n,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"topmenu_l"},[e("i",{staticClass:"el-icon-document title"}),this._v(" "),e("span",{staticClass:"title"},[this._v("活动管理")])])}],!1,null,"39b84f81",null);c.options.__file="src/page/activityManage/activityList.vue",e.default=c.exports},27:function(t,e){function a(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=a=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=a=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),a(e)}t.exports=a,t.exports.default=t.exports,t.exports.__esModule=!0},49:function(t,e,a){var n=a(122);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals),(0,a(4).default)("139221c3",n,!1,{})}}]);